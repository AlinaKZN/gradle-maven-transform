buildscript {
	repositories {
		mavenCentral()
	}
	def pluginVersion = file('../../version.txt').text.trim()
	dependencies {
		classpath "com.lazan:gradle-maven-transform:$pluginVersion"
	}
}

apply plugin: 'com.lazan.maven-transform'

mavenTransform {
	rootPom '../smallJavaMultiProject/pom.xml'
	outputDirectory "$buildDir/mavenTransform"

	transformManyToOne {
		outputPath "settings.gradle"
		freemarkerTemplate 'settings-projects.ftl'
		context 'modelCount', { Collection models ->
			models.size()
		}
		classpath files('src/main/resources')
	}

	transformOneToOne {
		outputPath { mavenModel -> "${mavenModel.artifactId}.gradle" }
		classpath files('src/main/resources')
	}
}	
