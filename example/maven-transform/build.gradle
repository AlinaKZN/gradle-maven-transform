buildscript {
	repositories {
		mavenCentral()
	}
	def pluginVersion = file('../../version.txt').text.trim()
	dependencies {
		classpath "com.lazan:gradle-maven-transform:$pluginVersion"
	}
}

apply plugin: 'com.lazan.maven-transform'

mavenTransform {
	rootPom '../smallJavaMultiProject/pom.xml'
	outputDirectory "$buildDir/mavenTransform"

	transformManyToOne {
		outputPath "$buildDir/mavenTransform/settings.gradle"
		freemarkerTemplate 'settings-projects.ftl'
		context 'modelCount', { Collection models ->
			models.size()
		}
	}

	transformOneToOne {
		outputPath { mavenModel ->
			"$buildDir/mavenTransform/${mavenModel.artifactId}.gradle"
		}
	}
}	
